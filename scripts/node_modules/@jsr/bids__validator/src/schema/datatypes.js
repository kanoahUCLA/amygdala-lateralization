import { memoize } from "../utils/memoize.js";
function _modalityTable(schema) {
  const modalities = {};
  const rules = schema.rules?.modalities ?? {};
  for (const [modality, { datatypes }] of Object.entries(rules)){
    for (const datatype of datatypes){
      modalities[datatype] = modality;
    }
  }
  return modalities;
}
// Construct once per schema; should only be multiple in tests
export const modalityTable = memoize(_modalityTable);
export function findDatatype(file, schema) {
  const lookup = modalityTable(schema);
  const datatype = file.parent?.name;
  if (!schema?.objects?.datatypes[datatype]) {
    return {
      datatype: '',
      modality: ''
    };
  }
  const modality = lookup[datatype] ?? '';
  return {
    datatype,
    modality
  };
}
//# sourceMappingURL=datatypes.js.map